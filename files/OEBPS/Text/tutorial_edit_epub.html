<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

    <title>Edit an EPUB</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="../../stylesheet.css" type="text/css" rel="stylesheet"/>
<link href="../../page_styles.css" type="text/css" rel="stylesheet"/>

  


<link href="../../calibreHtmlOutBasicCss.css" type="text/css" rel="stylesheet" />

</head>
<body>

<div class="calibreMeta">
  <div class="calibreMetaTitle">
  
  
    
    <h1>
      <a href="../../../index.html">Sigil User Guide
</a>
    </h1>
    
    
  
  </div>
  <div class="calibreMetaAuthor">
    0.6.0 draft

  </div>
</div>

<div class="calibreMain">

  <div class="calibreEbookContent">
    
      <div class="calibreEbNavTop">
        
          <a href="tutorial_create_epub.html" class="calibreAPrev">previous page</a>
        

        
          <a href="tutorial_regex.html" class="calibreANext"> next page</a>
        
      </div>
    

    
  <h2 id="tutorial" class="calibre6">Edit an EPUB</h2>

  <p class="h2subheading">— Using Code View and Find &amp; Replace —</p>

  <p class="calibre1">This tutorial shows you how to get started with advanced editing of an EPUB in Sigil.</p>

  <h3 class="sigilnotintoc">Basic Editing</h3>

  <p class="calibre1">If all you want to do is make a few simple changes in your book, then you can just open each of the files (by double-clicking on them in the Book Browser) and make the corrections in Book View. Then save your EPUB.</p>

  <p class="calibre1">But if you want to do more significant changes then you need to learn about Code View and Find &amp; Replace.</p>

  <h3 class="sigilnotintoc">Introducing Code View</h3>

  <p class="calibre1">Up to now you have probably only been viewing your text exactly as ereaders would display your book – using the WYSIWYG Book View mode in Sigil.</p>

  <p class="calibre1">However, your text is not actually stored in an EPUB looking like it does in Book View. In fact, it is stored in HTML format – which is a mix of your text and HTML tags that tell ereaders how to interpret and display your book.</p>

  <p class="calibre1">You can see the HTML code in your files by using Code View.</p>

  <p class="calibre1">So why do you need to know all this? Because in order to bulk edit text or to control the formatting of your book easily, you need to use Code View. And as its name implies, Code View shows you the raw HTML code that makes up your book.</p>

  <h4 class="sigilnotintoc1">Code View</h4>

  <p class="calibre1">To switch to Code View, use <span class="shortcut">View<span class="menuitem">→</span>Code View</span>. You can switch back to Book View at any time by using <span class="shortcut">View<span class="menuitem">→</span>Book View</span>. Or you can use the Book View and Code View icons on the toolbar.</p>

  <p class="calibre1">This is what Code View looks like:</p>

  <div class="image"><img alt="" src="../Images/tutorial_edit_code_view.png" class="calibre3"/></div>

  <p class="calibre1">That's quite a lot of text, but its not as jumbled as it appears. First, ignore everything at the top of the file up to and including the line <span class="example">&lt;body&gt;</span> as it is just information required by HTML files and usually the same in every file.</p>

  <p class="calibre1">Your text starts after the <span class="example">&lt;body&gt;</span> tag – you can see the chapter name and several paragraphs of text, along with other odd looking codes explained below.</p>

  <h4 class="sigilnotintoc1">HTML Basics</h4>

  <p class="calibre1">A full description of HTML is beyond this tutorial, but understanding the basics will help you edit your text.</p>

  <p class="calibre1">If you look at the HTML version of your file in Code View you will see lots of words like <span class="example">&lt;p&gt;</span> or <span class="example">&lt;h1&gt;</span>, etc. These are the HTML tags that tell ereaders what to do with your text.</p>

  <p class="calibre1">For instance, the HTML code below tells the ereader that the text <span class="example">Chapter 8</span> is a level 1 Heading:</p>
  <pre class="example1">&lt;h1&gt;Chapter 8&lt;/h1&gt;</pre>

  <p class="calibre1">The <span class="example">&lt;h1&gt;</span> tag is the start of the text to be treated like a heading, and the <span class="example">&lt;/h1&gt;</span> tag indicates the end of the text included in the heading. Depending upon some other settings, ereaders will typically make the text of a heading larger and center it on the screen.</p>

  <p class="calibre1">And the HTML code below tells the ereader that the text <span class="example">This is a paragraph</span> is an ordinary paragraph. Since its a paragraph the ereader will apply a certain formatting, perhaps indenting the first line.</p>
  <pre class="example1">&lt;p&gt;This is a paragraph.&lt;/p&gt;</pre>

  <p class="calibre1">Tags can get more fancy since they can include attributes that modify how they are interpreted. For example, the following paragraph tag (<span class="example">p</span>) has an attribute called <span class="example">style</span> with a value of <span class="example">font-weight: bold</span>:</p>
  <pre class="example1">&lt;p style="font-weight: bold"&gt;A bold paragraph&lt;/p&gt;</pre>

  <p class="calibre1">The code tells ereaders that for this particular paragraph, the style of the text should be bold.</p>

  <p class="calibre1">These are just a few examples of HTML code, but they give you an idea of what the majority of HTML is all about.</p>

  <p class="calibre1">What is important to remember is that in Code View you have access to both your text and the formatting codes that control the look of your book – so you can find and change them. Sigil provides a way to easily edit your text and HTML tags.</p>

  <div class="tip">
    <p class="tiptext">See the <a href="../Text/introduction.html">Introduction</a>, <a href="../Text/code_view.html">Code View</a> and <a href="../Text/tutorial_stylesheets.html">Stylesheets</a> chapters for more details.</p>
  </div>

  <h4 class="sigilnotintoc1">Editing in Code View</h4>

  <p class="calibre1">Once you are in Code View you can edit your text just like in Book View. Try changing some of your words (but not the HTML tags just yet), and then switch back to Book View. You will see the updates you made. In fact, any changes you make in Book View or Code View will be visible in the other view as they both only change one copy of your file.</p>

  <div class="tip">
    <p class="tiptext">Unlike Book View, where you can make whatever changes you want without breaking your EPUB, when you are in Code View it is essential that you edit carefully. You will need to make sure all the tags you use are valid and are opened and closed properly – if they aren't, you will get a warning when you try to save and you will be unable to save your EPUB until they are fixed.</p>
  </div>

  <div class="tip">
    <p class="tiptext">Save often to have your code checked for any errors to catch them early.</p>
  </div>

  <h3 class="sigilnotintoc">Introducing Find &amp; Replace</h3>

  <p class="calibre1">In Sigil, Find &amp; Replace can be used to find any text in any of your files. And even more important, it can be used to change text – but only in Code View.</p>

  <p class="calibre1">To open the Find &amp; Replace, use <span class="shortcut">Search<span class="menuitem">→</span>Find / Replace</span>. The window will remain open and below the editing window until you close it.</p>

  <p class="calibre1">This is the Find &amp; Replace window in Book View:</p>

  <div class="image"><img alt="" src="../Images/tutorial_find_book_view.png" class="calibre3"/></div>

  <p class="calibre1">As you can see, in Book View you only have the option to Find text.</p>

  <p class="calibre1">You need to switch to Code View to see the full set of options available in Find &amp; Replace.</p>

  <h4 class="sigilnotintoc1">Find &amp; Replace in Code View</h4>

  <p class="calibre1">In Code View, to open Find &amp; Replace use <span class="shortcut">Search<span class="menuitem">→</span>Find / Replace</span> or the <span class="shortcut">Ctrl+F</span> keyboard shortcut:</p>

  <div class="image"><img alt="" src="../Images/tutorial_find_empty.png" class="calibre3"/></div>

  <div class="tip">
    <p class="tiptext">The Find and Replace text boxes are where you enter what to look for and change. The four buttons on the right (Find, Count All, Replace, Replace All) are used to run your search. The Mode dropdown boxes on the bottom allow you to change what to search for, where to search, and which direction to search in.</p>

    <p class="tiptext">Each dropdown and button has a tooltip with more details.</p>
  </div>

  <p class="calibre1">To make a simple change enter some text to search for in the Find box, and what to replace it with in the Replace box, then click Replace:</p>

  <div class="image"><img alt="" src="../Images/tutorial_find_text.png" class="calibre3"/></div>

  <p class="calibre1">Or click on Count All to show how many matches there are:</p>

  <div class="image"><img alt="" src="../Images/tutorial_find_count.png" class="calibre3"/></div>

  <p class="calibre1">To test Find, enter a search string and click Find a few times (any text in the Replace box is ignored if you are just doing a Find or Count All). Your matched text will be highlighted in the Code View window.</p>

  <p class="calibre1">Now click on Replace.</p>

  <p class="calibre1">Since your matched text was already highlighted, Sigil has replaced it with your new text (which could be empty if you wanted to delete that text in your document) and then automatically found and highlighted the next match. If matching text wasn't highlighted already, then Replace would have just found and highlighted the next match without replacing it.</p>

  <p class="calibre1">You can scroll back to verify your text was replaced.</p>

  <p class="calibre1">If you are satisfied that the Replace is working okay, you can use Replace All to update all the matching text in your document at once instead of one at a time.</p>

  <div class="tip">
    <p class="tiptext">Always use Count All and possibly a few Replace commands before using Replace All – to make sure you have entered your find and replace strings correctly.</p>
  </div>

  <p class="calibre1">You may have noticed the selection box containing Current HTML File. If you change Current HTML File to All HTML Files, your Find or Replace will be done across every HTML file in your EPUB:</p>

  <div class="image"><img alt="" src="../Images/tutorial_find_empty_all.png" class="calibre3"/></div>

  <p class="calibre1">This is why editing in Sigil can be done quickly.</p>

  <h4 class="sigilnotintoc1">Advanced Find &amp; Replace – Regex</h4>

  <p class="calibre1">The real power of Find &amp; Replace in Sigil is provided by its support of Regular Expressions (also called regex).</p>

  <p class="calibre1">You use regex in Find &amp; Replace by changing the mode of the search from Normal to Regex.</p>

  <div class="image"><img alt="" src="../Images/tutorial_find_empty_regex.png" class="calibre3"/></div>

  <p class="calibre1">Regex is a very important tool in Sigil, but only a very brief introduction can be given in this tutorial.</p>

  <p class="calibre1">For example, instead of searching for very specific text to replace or delete, such as "Page 123", it would be much more useful to search for text that contains "Page" followed by a number – that's exactly what regular expressions can provide.</p>

  <p class="calibre1">Instead of putting your actual text into the Find or Replace boxes, you can substitute it with special regex codes. So in the example above you could search for "Page \d+" instead of "Page 123" because "\d+" is a regex code that means any digit repeated at least once.</p>

  <div class="image"><img alt="" src="../Images/tutorial_find_regex_basic.png" class="calibre3"/></div>

  <h4 class="sigilnotintoc1">Using Regex to Replace Text</h4>

  <p class="calibre1">But even more useful is that you can use regex to help with replacing text as well. In the example above, you might want to keep the page numbers but replace the word "Page". You could use then use something like:</p>

  <ul class="calibre4">
    <li class="calibre5">
      <span class="listheading">Find:</span>
      <pre class="example1">Page (\d+)</pre>
    </li>

    <li class="calibre5">
      <span class="listheading">Replace:</span>
      <pre class="example1">This is page number \1</pre>
    </li>
  </ul>

  <div class="image"><img alt="" src="../Images/tutorial_find_regex_group.png" class="calibre3"/></div>

  <p class="calibre1">This will replace any occurrence of "Page" followed by a number with "This is a page" followed by the same number:</p>

  <ul class="calibre4">
    <li class="calibre5">
      <span class="listheading">Before:</span>
      <pre class="example1">Page 418</pre>
    </li>

    <li class="calibre5">
      <span class="listheading">After:</span>
      <pre class="example1">This is page number 418</pre>
    </li>
  </ul>

  <p class="calibre1">The first point to note about this replacement is the use of the regex code <span class="example">(\d+)</span> in the Find box. The <span class="example">\d+</span> code tells the search to look for numbers as above. But the use of parenthesis around the code tells the search to remember what those numbers were. The other point to note is the use of the regex code <span class="example">\1</span> in the Replace box which tells Replace to substitute the characters remembered in the Find statement for the string <span class="example">\1</span> wherever it finds it.</p>

  <h4 class="sigilnotintoc1" id="tutorial_regex_formatting">Using Regex to Change Formatting</h4>

  <p class="calibre1">As a further example of regex, this is how you might change the formatting of certain text into chapter headings.</p>

  <p class="calibre1">Let's say that you have an imported HTML file that contains lots of chapter headings, but none of them are marked using the <span class="example">h1</span> heading tag. Instead they are all marked as paragraphs like this:</p>
  <pre class="example1">&lt;p&gt;CHAPTER 7&lt;/p&gt;
</pre>

  <p class="calibre1">Assuming every paragraph like this is a chapter heading, you could use this regex:</p>

  <ul class="calibre4">
    <li class="calibre5">
      <span class="listheading">Find:</span>
      <pre class="example1">&lt;p&gt;\sCHAPTER\s(\d+)\s&lt;/p&gt;</pre>
    </li>

    <li class="calibre5">
      <span class="listheading">Replace:</span>
      <pre class="example1">&lt;h1&gt;Chapter \1&lt;/h1&gt;</pre>
    </li>
  </ul>

  <div class="image"><img alt="" src="../Images/tutorial_find_regex_chapter.png" class="calibre3"/></div>

  <p class="calibre1">That's quite a lot to digest, but if you look carefully you can see that its very similar to the Page number example above in that its remembering the digits in the chapter name and using them in the replace.</p>

  <p class="calibre1">Its the Find that is the most interesting. It breaks down like this:</p>

  <ul class="calibre4">
    <li class="calibre5"><span class="example">&lt;p&gt;</span> – look for a starting paragraph tag</li>

    <li class="calibre5"><span class="example">\s</span> – regex code to match any white space (blanks, new lines, etc.)</li>

    <li class="calibre5"><span class="example">CHAPTER</span> – match the word CHAPTER (Regex is case-sensitive by default)</li>

    <li class="calibre5"><span class="example">\s</span> – regex code to match any white space (blanks, new lines, etc.)</li>

    <li class="calibre5"><span class="example">(\d+)</span> – regex code to match any number of digits in a row and remember them</li>

    <li class="calibre5"><span class="example">\s</span> – regex code to match any white space (blanks, new lines, etc.)</li>

    <li class="calibre5"><span class="example">&lt;p&gt;</span> – look for an end paragraph tag</li>
  </ul>

  <p class="calibre1">You could just use a space instead of <span class="example">\s</span> but <span class="example">\s</span> is more flexible since it will match any number of blank spaces and tabs and even across new lines (regex only searches one line by default).</p>

  <p class="calibre1">So the results of that search could be:</p>

  <ul class="calibre4">
    <li class="calibre5">
      <span class="listheading">Before:</span>
      <pre class="example1">&lt;p&gt;  CHAPTER    14
&lt;/p&gt;</pre>
    </li>

    <li class="calibre5">
      <span class="listheading">After:</span>
      <pre class="example1">&lt;h1&gt;Chapter 14&lt;h1&gt;</pre>
    </li>
  </ul>

  <div class="tip">
    <p class="tiptext">It becomes more difficult to use regex if the formatting used in a file is not consistent – in these cases you may have to do several Find &amp; Replace passes and even resort to making the updates one by one manually.</p>
  </div>

  <p class="calibre1">This is only a very basic description of what regex is, but it gives you an idea of what is possible. The trick with regex is getting the right find and replace strings, and that only comes from reading, asking questions, and experience.</p>

  <p class="calibre1">See the <a href="../Text/tutorial_regex.html">Regular Expressions</a> chapter for more details.</p>



  </div>

  
  <div class="calibreToc">
    <h2><a href="../../../index.html"> Table of contents</a></h2>
     <div>
  <ul>
    <li>
      <a href="cover_picture.html">Cover</a>
    </li>
    <li>
      <a href="titlepage.html">Titlepage</a>
    </li>
    <li>
      <a href="rights.html">Copyright</a>
    </li>
    <li>
      <a href="introduction.html">Introduction</a>
      <ul>
        <li>
          <a href="whats_new.html">What's New</a>
        </li>
        <li>
          <a href="about_sigil.html">About Sigil</a>
        </li>
        <li>
          <a href="about_epub.html">About EPUB</a>
        </li>
      </ul>
    </li>
    <li>
      <a href="installation.html">Installation</a>
      <ul>
        <li>
          <a href="installation.html#installation_windows">Windows</a>
        </li>
        <li>
          <a href="installation.html#installation_mac">Mac</a>
        </li>
        <li>
          <a href="installation.html#installation_linux">Linux</a>
        </li>
      </ul>
    </li>
    <li>
      <a href="features.html">Features</a>
      <ul>
        <li>
          <a href="user_interface.html">User Interface</a>
        </li>
        <li>
          <a href="preferences.html">Preferences</a>
        </li>
        <li>
          <a href="opening_and_saving_files.html">Opening and Saving Files</a>
        </li>
        <li>
          <a href="book_view.html">Book View</a>
        </li>
        <li>
          <a href="code_view.html">Code View</a>
        </li>
        <li>
          <a href="preview_view.html">Preview View</a>
        </li>
        <li>
          <a href="book_browser.html">Book Browser</a>
        </li>
        <li>
          <a href="table_of_contents.html">Table of Contents (TOC)</a>
        </li>
        <li>
          <a href="metadata.html">Metadata</a>
        </li>
        <li>
          <a href="validation.html">Validation</a>
        </li>
        <li>
          <a href="spellcheck.html">Spellcheck</a>
        </li>
        <li>
          <a href="images.html">Images</a>
        </li>
        <li>
          <a href="special_characters.html">Special Characters</a>
        </li>
        <li>
          <a href="splitting_and_merging.html">Splitting and Merging</a>
        </li>
        <li>
          <a href="find_replace.html">Find &amp; Replace</a>
        </li>
        <li>
          <a href="saved_searches.html">Saved Searches</a>
        </li>
        <li>
          <a href="clips.html">Clips</a>
        </li>
        <li>
          <a href="clipboard_history.html">Clipboard History</a>
        </li>
        <li>
          <a href="links.html">Links and IDs</a>
        </li>
        <li>
          <a href="styles.html">Styles</a>
        </li>
        <li>
          <a href="indexes.html">Indexes</a>
        </li>
        <li>
          <a href="reports.html">Reports</a>
        </li>
        <li>
          <a href="external_editors.html">External Editors</a>
        </li>
      </ul>
    </li>
    <li>
      <a href="tutorials.html">Tutorials</a>
      <ul>
        <li>
          <a href="tutorial_create_epub.html">Create an EPUB</a>
        </li>
        <li>
          <a href="tutorial_edit_epub.html">Edit an EPUB</a>
        </li>
        <li>
          <a href="tutorial_regex.html">Use Regular Expressions</a>
        </li>
        <li>
          <a href="tutorial_links.html">Create Links and Footnotes</a>
        </li>
        <li>
          <a href="tutorial_stylesheets.html">Use Stylesheets</a>
        </li>
        <li>
          <a href="tutorial_embed_fonts.html">Include Custom Fonts</a>
        </li>
        <li>
          <a href="tutorial_tips.html">Tips</a>
        </li>
      </ul>
    </li>
    <li>
      <a href="faq.html">FAQ</a>
      <ul>
        <li>
          <a href="faq.html#faq_common_questions">Common Questions</a>
        </li>
        <li>
          <a href="faq.html#faq_questions">Where to Get Help</a>
        </li>
        <li>
          <a href="faq.html#faq_starting_sigil">Starting Sigil</a>
        </li>
        <li>
          <a href="faq.html#faq_using_sigil">Using Sigil</a>
        </li>
        <li>
          <a href="faq.html#faq_formatting">Formatting and Styles</a>
        </li>
      </ul>
    </li>
    <li>
      <a href="contributing_to_sigil.html">Contributing to Sigil</a>
    </li>
  </ul>
</div>


  </div>
  

  <div class="calibreEbNav">
    
      <a href="tutorial_create_epub.html" class="calibreAPrev">previous page</a>
    

    <a href="../../../index.html" class="calibreAHome"> start</a>

    
      <a href="tutorial_regex.html" class="calibreANext"> next page</a>
    
  </div>

</div>

</body>
</html>
